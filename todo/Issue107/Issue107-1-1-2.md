ilakkuvaselvimanoharan@MacBookPro tts-next-fast-aws % aws ecs list-task-definitions --sort DESC --output text

TASKDEFINITIONARNS      arn:aws:ecs:us-east-1:681916125840:task-definition/tts-next-fast-aws-dev-backend:7
TASKDEFINITIONARNS      arn:aws:ecs:us-east-1:681916125840:task-definition/tts-next-app-dev-backend:1
TASKDEFINITIONARNS      arn:aws:ecs:us-east-1:681916125840:task-definition/tts-backend-task:2
TASKDEFINITIONARNS      arn:aws:ecs:us-east-1:681916125840:task-definition/tts-backend-task:1

Perfect — now we can see your **latest task definition ARN** is:

```
arn:aws:ecs:us-east-1:681916125840:task-definition/tts-next-fast-aws-dev-backend:7
```

So the **task definition family** is:

```
tts-next-fast-aws-dev-backend
```

---

### Step 1 — Get the task role ARN

```bash
aws ecs describe-task-definition \
  --task-definition tts-next-fast-aws-dev-backend:7 \
  --query 'taskDefinition.taskRoleArn' \
  --output text \
  --region us-east-1
```

Example output might be:

```
arn:aws:iam::681916125840:role/ecsTaskRole
```

---

### Step 2 — Extract the role name

```bash
TASK_ROLE_NAME=$(aws ecs describe-task-definition \
  --task-definition tts-next-fast-aws-dev-backend:7 \
  --query 'taskDefinition.taskRoleArn' \
  --output text \
  --region us-east-1 | awk -F'/' '{print $NF}')

echo "$TASK_ROLE_NAME"
```

Now `$TASK_ROLE_NAME` contains the exact IAM role name you need for `put-role-policy`.

---

### Step 3 — Attach your S3 policy

```bash
aws iam put-role-policy \
  --role-name "$TASK_ROLE_NAME" \
  --policy-name S3AudioAccess \
  --policy-document file://s3-audio-policy.json
```

This attaches the inline policy giving `ListBucket`, `GetObject`, and `PutObject` permissions on your bucket `ts-audio-ilakkm-aug31`.

---

If you want, I can give a **single script that automatically fetches the latest task definition and attaches the policy** in one go, so you don’t have to copy ARNs manually. Do you want me to do that?


ilakkuvaselvimanoharan@MacBookPro tts-next-fast-aws % aws ecs list-task-definitions --sort DESC --output text

TASKDEFINITIONARNS      arn:aws:ecs:us-east-1:681916125840:task-definition/tts-next-fast-aws-dev-backend:7
TASKDEFINITIONARNS      arn:aws:ecs:us-east-1:681916125840:task-definition/tts-next-app-dev-backend:1
TASKDEFINITIONARNS      arn:aws:ecs:us-east-1:681916125840:task-definition/tts-backend-task:2
TASKDEFINITIONARNS      arn:aws:ecs:us-east-1:681916125840:task-definition/tts-backend-task:1
ilakkuvaselvimanoharan@MacBookPro tts-next-fast-aws % aws ecs describe-task-definition \
  --task-definition tts-next-fast-aws-dev-backend:7 \
  --query 'taskDefinition.taskRoleArn' \
  --output text \
  --region us-east-1

arn:aws:iam::681916125840:role/tts-next-fast-aws-dev-backend-TaskRole-Z4lBW81EsCnG
